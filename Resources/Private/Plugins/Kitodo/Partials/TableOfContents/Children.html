<f:comment>
<!--
 * (c) Kitodo. Key to digital objects e.V. <contact@kitodo.org>
 *
 * This file is part of the Kitodo and TYPO3 projects.
 *
 * @license GNU General Public License version 3 or later.
 * For the full copyright and license information, please read the
 * LICENSE.txt file that was distributed with this source code.
-->
</f:comment>
<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
      data-namespace-typo3-fluid="true">

<f:for each="{children}" as="child">
    <f:switch expression="{child.ITEM_STATE}">
        <f:case value="ACT">
            <li class="active">
        </f:case>
        <f:case value="CUR">
            <li class="current">
        </f:case>
        <f:case value="ACTIFSUB">
            <f:if condition="{child.doNotLinkIt}">
                <f:then>
                    <li class="active submenu doNotLinkIt"></li>
                </f:then>
                <f:else>
                    <li class="active submenu">
                </f:else>
            </f:if>

        </f:case>
        <f:case value="CURIFSUB">
            <li class="current submenu">
        </f:case>
        <f:case value="IFSUB">
            <f:if condition="{child.doNotLinkIt}">
                <f:then>
                    <li class="submenu doNotLinkIt">
                </f:then>
                <f:else>
                    <li class="submenu">
                </f:else>
            </f:if>
        </f:case>
        <f:defaultCase>
            <li>
        </f:defaultCase>
    </f:switch>

    <f:if condition="{child.doNotLinkIt}">
        <f:then>

            <span class="a doNotLinkIt">
                <f:comment><f:debug>{_all}</f:debug></f:comment>
                <f:render partial="TableOfContents/Title" arguments="{child: child}"/>
            </span>

        </f:then>
        <f:else>
            <f:comment>hier steckt der Fehler bei zeitungen issues
                additionalParams="{f:if(condition:'{child.id}', then:'{\'tx_dlf[id]\':child.id, \'tx_dlf[page]\':child.page}', else: '{\'tx_dlf[page]\':child.page}')}"
                wenn dieser Teil weggelassen wird funktioniert scheinbar alles
            </f:comment>
            <f:if condition="{child.ITEM_STATE} == 'ACTIFSUB' && ({child.type} == 'Zeitung' || {child.type} == 'Newspaper') ">
                <f:then>
                    <f:comment><f:debug>{_all}</f:debug></f:comment>
                    <f:comment><f:debug>Diese Bedingung trifft zu auf Issues bei Zeitungen</f:debug></f:comment>
                    <f:comment>
                        Wir das untere Statement bei der Ausgaben-Ebene von Zeitungen eingebunden wird ein oops-Error geschmissen
                        Ursache koennte ev. ein Problem mit der child.id sein, diese ist bei meinem ersten Testfall eine URL und nicht eine Zahle
                        aktuell kann ich aber keine Pruefung auf Zahlen durchfuehren
                    </f:comment>
                </f:then>
                <f:else>
          
                    <f:link.action
                        action="main"
                        pageUid="{settings.targetPid}"
                        additionalParams="{f:if(condition:'{child.id}', then:'{\'tx_dlf[id]\':child.id, \'tx_dlf[page]\':child.page}', else: '{\'tx_dlf[page]\':child.page}')}"
                        addQueryString="1"
                        addQueryStringMethod="GET"
                        title="{f:if(condition:'{child.title}', then: '{child.title}', else: '{child.type}')}">
                            <f:render partial="TableOfContents/Title" arguments="{child: child}"/>
                    </f:link.action>
                </f:else>
            </f:if>
        </f:else>
    </f:if>

    <f:if condition="{settings.basketButton} && {settings.targetBasket}">
        <span class="tx-dlf-basket-button">
                <f:link.action
                    pageUid="{settings.targetBasket}"
                    action="main"
                    controller="Basket"
                    additionalParams="{'tx_dlf[addToBasket]':'toc', 'tx_dlf[logId]':child.basketButton.logId, 'tx_dlf[startpage]':child.basketButton.startpage, 'tx_dlf_basket[action]':'add', 'tx_dlf_basket[controller]':'Basket'}"
                    addQueryString="1">
                        <f:translate key="AddToBasket" />
                </f:link.action>
        </span>
    </f:if>

    <f:if condition="{child._SUB_MENU} && ({child.ITEM_STATE} == 'IFSUB' || {child.ITEM_STATE} == 'ACTIFSUB' || {child.ITEM_STATE} == 'CURIFSUB')">
        <f:comment><f:debug>{_all}</f:debug></f:comment>
        <f:if condition="{child.doNotLinkIt}">
            <f:then>
                <ul class="doNotLinkIt">
            </f:then>
            <f:else>
                <ul class="normal">
            </f:else>
        </f:if>            
            <f:render partial="TableOfContents/Children" arguments="{children: child._SUB_MENU}"/>
        </ul>
    </f:if>

    </li>
</f:for>
